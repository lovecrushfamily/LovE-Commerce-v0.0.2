self.TrackJS=self.trackJs=function(h,r,s){"use awesome";var n=function(t,e){this.config=t;this.onError=e;t.enabled&&this.watch()};n.prototype={watch:function(){p.forEach(["EventTarget","Node","XMLHttpRequest"],function(t){p.has(h,t+".prototype.addEventListener")&&p.hasOwn(h[t].prototype,"addEventListener")&&this.wrapEventTarget(h[t].prototype)},this);this.wrapTimer("setTimeout");this.wrapTimer("setInterval")},wrap:function(e){function t(){try{return e.apply(this,arguments)}catch(t){throw r.onError("catch",t,{bindTime:n,bindStack:i}),p.wrapError(t)}}var r=this;try{if(!p.isFunction(e)||p.hasOwn(e,"__trackjs__"))return e;if(p.hasOwn(e,"__trackjs_state__"))return e.__trackjs_state__}catch(t){return e}var n,i;if(r.config.bindStack)try{throw Error()}catch(t){i=t.stack,n=p.isoNow()}for(var o in e)p.hasOwn(e,o)&&(t[o]=e[o]);t.prototype=e.prototype;t.__trackjs__=!0;return e.__trackjs_state__=t},wrapEventTarget:function(t){var o=this;p.has(t,"addEventListener.call")&&p.has(t,"removeEventListener.call")&&(p.patch(t,"addEventListener",function(i){return function(t,e,r,n){try{p.has(e,"handleEvent")&&(e.handleEvent=o.wrap(e.handleEvent))}catch(t){}return i.call(this,t,o.wrap(e),r,n)}}),p.patch(t,"removeEventListener",function(i){return function(t,e,r,n){try{e=e&&(e.__trackjs_state__||e)}catch(t){}return i.call(this,t,e,r,n)}}))},wrapTimer:function(t){var o=this;p.patch(h,t,function(i){return function(t,e){var r=Array.prototype.slice.call(arguments),n=r[0];p.isFunction(n)&&(r[0]=o.wrap(n));return p.has(i,"apply")?i.apply(this,r):i(r[0],r[1])}})}};var i=function(t){this.initCurrent(t)||console.warn("[TrackJS] invalid config")};i.prototype={current:{},initOnly:{application:!0,cookie:!0,enabled:!0,token:!0,callback:{enabled:!0},console:{enabled:!0},navigation:{enabled:!0},network:{enabled:!0,fetch:!0},visitor:{enabled:!0},window:{enabled:!0,promise:!0}},defaults:{application:"",cookie:!1,dedupe:!0,dependencies:!0,enabled:!0,forwardingDomain:"",errorURL:"https://capture.trackjs.com/capture",errorNoSSLURL:"http://capture.trackjs.com/capture",faultURL:"https://usage.trackjs.com/fault.gif",usageURL:"https://usage.trackjs.com/usage.gif",onError:function(){return!0},serialize:function(e){function r(t){var e="<"+t.tagName.toLowerCase();t=t.attributes||[];for(var r=0;r<t.length;r++)e+=" "+t[r].name+'="'+t[r].value+'"';return e+">"}if(""===e)return"Empty String";if(e===s)return"undefined";if(p.isString(e)||p.isNumber(e)||p.isBoolean(e)||p.isFunction(e))return""+e;if(p.isElement(e))return r(e);if("symbol"===typeof e)return Symbol.prototype.toString.call(e);var n;try{n=JSON.stringify(e,function(t,e){return e===s?"undefined":p.isNumber(e)&&isNaN(e)?"NaN":p.isError(e)?{name:e.name,message:e.message,stack:e.stack}:p.isElement(e)?r(e):e})}catch(t){n="";for(var i in e)if(e.hasOwnProperty(i))try{n+=',"'+i+'":"'+e[i]+'"'}catch(t){}n=n?"{"+n.replace(",","")+"}":"Unserializable Object"}return n.replace(/"undefined"/g,"undefined").replace(/"NaN"/g,"NaN")},sessionId:"",token:"",userId:"",version:"",callback:{enabled:!0,bindStack:!1},console:{enabled:!0,display:!0,error:!0,warn:!1,watch:["log","debug","info","warn","error"]},navigation:{enabled:!0},network:{enabled:!0,error:!0,fetch:!0},visitor:{enabled:!0},window:{enabled:!0,promise:!0}},initCurrent:function(t){this.removeEmpty(t);if(this.validate(t,this.defaults,"[TrackJS] config",{}))return this.current=p.defaultsDeep({},t,this.defaults),!0;this.current=p.defaultsDeep({},this.defaults);return!1},setCurrent:function(t){return this.validate(t,this.defaults,"[TrackJS] config",this.initOnly)?(this.current=p.defaultsDeep({},t,this.current),!0):!1},removeEmpty:function(t){for(var e in t)t.hasOwnProperty(e)&&t[e]===s&&delete t[e]},validate:function(t,e,r,n){var i=!0;r=r||"";n=n||{};for(var o in t)if(t.hasOwnProperty(o))if(e.hasOwnProperty(o)){var a=typeof e[o];a!==typeof t[o]?(console.warn(r+"."+o+": property must be type "+a+"."),i=!1):"[object Array]"!==Object.prototype.toString.call(t[o])||this.validateArray(t[o],e[o],r+"."+o)?"[object Object]"===Object.prototype.toString.call(t[o])?i=this.validate(t[o],e[o],r+"."+o,n[o]):n.hasOwnProperty(o)&&(console.warn(r+"."+o+": property cannot be set after load."),i=!1):i=!1}else console.warn(r+"."+o+": property not supported."),i=!1;return i},validateArray:function(t,e,r){var n=!0;r=r||"";for(var i=0;i<t.length;i++)p.contains(e,t[i])||(console.warn(r+"["+i+"]: invalid value: "+t[i]+"."),n=!1);return n}};var o=function(t,e,r,n,i,o,a){this.util=t;this.log=e;this.onError=r;this.onFault=n;this.serialize=i;a.enabled&&(o.console=this.wrapConsoleObject(o.console,a))};o.prototype={wrapConsoleObject:function(n,i){n=n||{};var t=n.log||function(){},o=this,e;for(e=0;e<i.watch.length;e++)(function(e){var r=n[e]||t;n[e]=function(){try{var t=Array.prototype.slice.call(arguments);o.log.add("c",{timestamp:o.util.isoNow(),severity:e,message:o.serialize(1===t.length?t[0]:t)});if(i[e])if(p.isError(t[0])&&1===t.length)o.onError("console",t[0]);else try{throw Error(o.serialize(1===t.length?t[0]:t))}catch(t){o.onError("console",t)}i.display&&(o.util.hasFunction(r,"apply")?r.apply(n,t):r(t[0]))}catch(t){o.onFault(t)}}})(i.watch[e]);return n},report:function(){return this.log.all("c")}};var a=function(t,e,r,n,i){this.config=t;this.util=e;this.log=r;this.window=n;this.document=i;this.correlationId=this.token=null;this.initialize()};a.prototype={initialize:function(){this.token=this.getCustomerToken();this.correlationId=this.getCorrelationId()},getCustomerToken:function(){if(this.config.current.token)return this.config.current.token;var t=this.document.getElementsByTagName("script");return t[t.length-1].getAttribute("data-token")},getCorrelationId:function(){var e;if(!this.config.current.cookie)return this.util.uuid();try{e=this.document.cookie.replace(/(?:(?:^|.*;\s*)TrackJS\s*\=\s*([^;]*).*$)|^.*$/,"$1"),e||(e=this.util.uuid(),this.document.cookie="TrackJS="+e+"; expires=Fri, 31 Dec 9999 23:59:59 GMT; path=/")}catch(t){e=this.util.uuid()}return e},report:function(){return{application:this.config.current.application,correlationId:this.correlationId,sessionId:this.config.current.sessionId,token:this.token,userId:this.config.current.userId,version:this.config.current.version}}};var c=function(t){this.config=t;this.loadedOn=(new Date).getTime();this.originalUrl=p.getLocation();this.referrer=p.isBrowser?r.referrer:""};c.prototype={discoverDependencies:function(){var t={TrackJS:"3.10.4"};h.jQuery&&h.jQuery.fn&&h.jQuery.fn.jquery&&(t.jQuery=h.jQuery.fn.jquery);h.jQuery&&h.jQuery.ui&&h.jQuery.ui.version&&(t.jQueryUI=h.jQuery.ui.version);h.angular&&h.angular.version&&h.angular.version.full&&(t.angular=h.angular.version.full);for(var e in h)if("_trackJs"!==e&&"_trackJS"!==e&&"_trackjs"!==e&&"webkitStorageInfo"!==e&&"webkitIndexedDB"!==e&&"top"!==e&&"parent"!==e&&"frameElement"!==e)try{if(h[e]){var r=h[e].version||h[e].Version||h[e].VERSION;"string"===typeof r&&(t[e]=r)}}catch(t){}t.TrackJS&&t.trackJs&&delete t.trackJs;return t},report:function(){return{age:(new Date).getTime()-this.loadedOn,dependencies:this.config.current.dependencies?this.discoverDependencies():{trackJs:"3.10.4"},originalUrl:this.originalUrl,referrer:this.referrer,userAgent:h.navigator.userAgent,viewportHeight:p.isBrowser?h.document.documentElement.clientHeight:0,viewportWidth:p.isBrowser?h.document.documentElement.clientWidth:0}}};var e=function(t){this.util=t;this.appender=[];this.maxLength=30};e.prototype={all:function(t){var e=[],r,n;for(n=0;n<this.appender.length;n++)(r=this.appender[n])&&r.category===t&&e.push(r.value);return e},clear:function(){this.appender.length=0},truncate:function(){this.appender.length>this.maxLength&&(this.appender=this.appender.slice(Math.max(this.appender.length-this.maxLength,0)))},add:function(t,e){var r=this.util.uuid();this.appender.push({key:r,category:t,value:e});this.truncate();return r},get:function(t,e){var r,n;for(n=0;n<this.appender.length;n++)if(r=this.appender[n],r.category===t&&r.key===e)return r.value;return!1}};var u=function(r){var n={};return{addMetadata:function(t,e){n[t]=e},removeMetadata:function(t){delete n[t]},report:function(){var t=[],e;for(e in n)n.hasOwnProperty(e)&&t.push({key:e,value:r(n[e])});return t},store:n}},l=function(t,e){this.log=t;this.options=e;e.enabled&&this.watch()};l.prototype={isCompatible:function(t){t=t||h;return!p.has(t,"chrome.app.runtime")&&p.has(t,"addEventListener")&&p.has(t,"history.pushState")},record:function(t,e,r){this.log.add("h",{type:t,from:p.truncate(e,250),to:p.truncate(r,250),on:p.isoNow()})},report:function(){return this.log.all("h")},watch:function(){if(this.isCompatible()){var i=this,o=p.getLocationURL().relative;h.addEventListener("popstate",function(){var t=p.getLocationURL().relative;i.record("popState",o,t);o=t},!0);p.forEach(["pushState","replaceState"],function(n){p.patch(history,n,function(r){return function(){o=p.getLocationURL().relative;var t=r.apply(this,arguments),e=p.getLocationURL().relative;i.record(n,o,e);o=e;return t}})})}}};var d=function(t,e,r,n,i,o){this.util=t;this.log=e;this.onError=r;this.onFault=n;this.window=i;this.options=o;o.enabled&&this.initialize(i)};d.prototype={initialize:function(t){t.XMLHttpRequest&&this.util.hasFunction(t.XMLHttpRequest.prototype.open,"apply")&&this.watchNetworkObject(t.XMLHttpRequest);t.XDomainRequest&&this.util.hasFunction(t.XDomainRequest.prototype.open,"apply")&&this.watchNetworkObject(t.XDomainRequest);this.options.fetch&&p.isWrappableFunction(t.fetch)&&this.watchFetch()},escapeUrl:function(t){return(""+t).replace(/ /gi,"%20").replace(/\t/gi,"%09")},watchFetch:function(){var s=this,c=this.log,u=this.options,l=this.onError;p.patch(h,"fetch",function(a){return function(t,e){if(e&&e.__trackjs__)return a.apply(h,arguments);var n;try{throw Error()}catch(t){n=t.stack}var r=t instanceof Request?t.url:t,i=t instanceof Request?t.method:(e||{}).method||"GET",r=s.escapeUrl(r),o=a.apply(h,arguments);o.__trackjs_state__=c.add("n",{type:"fetch",startedOn:p.isoNow(),method:i,url:p.truncate(r,2e3)});return o.then(function(t){var e=c.get("n",o.__trackjs_state__);if(e){p.defaults(e,{completedOn:p.isoNow(),statusCode:t.status,statusText:t.statusText});var r=t.headers.get("trackjs-correlation-id");r&&(e.requestCorrelationId=r);u.error&&400<=t.status&&(e=Error(e.statusCode+" : "+e.method+" "+e.url),e.stack=n,l("ajax",e))}return t})["catch"](function(t){t=t||{};var e=c.get("n",o.__trackjs_state__);e&&(p.defaults(e,{completedOn:p.isoNow(),statusCode:0,statusText:t.toString()}),u.error&&(l("ajax",{name:t.name,message:(t.message||"Failed")+": "+e.method+" "+e.url,stack:t.stack||n}),t.__trackjs_state__=!0));throw t})}})},watchNetworkObject:function(t){var n=this,i=t.prototype.open,e=t.prototype.send;t.prototype.open=function(t,e){var r=(e||"").toString();0>r.indexOf("localhost:0")&&(r=n.escapeUrl(r),this._trackJs={method:t,url:r});return i.apply(this,arguments)};t.prototype.send=function(){if(!this._trackJs)try{return e.apply(this,arguments)}catch(t){n.onError("ajax",t);return}try{this._trackJs.logId=n.log.add("n",{type:"xhr",startedOn:n.util.isoNow(),method:this._trackJs.method,url:p.truncate(this._trackJs.url,2e3)}),n.listenForNetworkComplete(this)}catch(t){n.onFault(t)}return e.apply(this,arguments)};return t},listenForNetworkComplete:function(r){var n=this;n.window.ProgressEvent&&r.addEventListener&&r.addEventListener("readystatechange",function(){4===r.readyState&&n.finalizeNetworkEvent(r)},!0);r.addEventListener?r.addEventListener("load",function(){n.finalizeNetworkEvent(r);n.checkNetworkFault(r)},!0):setTimeout(function(){try{var t=r.onload;r.onload=function(){n.finalizeNetworkEvent(r);n.checkNetworkFault(r);"function"===typeof t&&n.util.hasFunction(t,"apply")&&t.apply(r,arguments)};var e=r.onerror;r.onerror=function(){n.finalizeNetworkEvent(r);n.checkNetworkFault(r);"function"===typeof oldOnError&&e.apply(r,arguments)}}catch(t){n.onFault(t)}},0)},finalizeNetworkEvent:function(t){if(t._trackJs){var e=this.log.get("n",t._trackJs.logId);e&&(e.completedOn=this.util.isoNow(),t.getAllResponseHeaders&&t.getResponseHeader&&0<=(t.getAllResponseHeaders()||"").toLowerCase().indexOf("trackjs-correlation-id")&&(e.requestCorrelationId=t.getResponseHeader("trackjs-correlation-id")),e.statusCode=1223==t.status?204:t.status,e.statusText=1223==t.status?"No Content":t.statusText)}},checkNetworkFault:function(t){if(this.options.error&&400<=t.status&&1223!=t.status){var e=t._trackJs||{};this.onError("ajax",t.status+" : "+e.method+" "+e.url)}},report:function(){return this.log.all("n")}};var f=function(t,e){this.util=t;this.config=e;this.disabled=!1;this.throttleStats={attemptCount:0,throttledCount:0,lastAttempt:(new Date).getTime()};h.JSON&&h.JSON.stringify||(this.disabled=!0)};f.prototype={errorEndpoint:function(t){var e=this.config.current,r=e.errorURL;p.isBrowser&&!p.testCrossdomainXhr()&&-1===h.location.protocol.indexOf("https")?r=e.errorNoSSLURL:e.forwardingDomain&&(r="https://"+e.forwardingDomain+"/capture");return r+"?token="+t+"&v=3.10.4"},usageEndpoint:function(t){var e=this.config.current,r=e.usageURL;e.forwardingDomain&&(r="https://"+e.forwardingDomain+"/usage.gif");return this.appendObjectAsQuery(t,r)},trackerFaultEndpoint:function(t){var e=(this.config||{}).current||i.prototype.defaults,r=e.faultURL;e.forwardingDomain&&(r="https://"+e.forwardingDomain+"/fault.gif");return this.appendObjectAsQuery(t,r)},appendObjectAsQuery:function(t,e){e+="?";for(var r in t)t.hasOwnProperty(r)&&(e+=encodeURIComponent(r)+"="+encodeURIComponent(t[r])+"&");return e},getCORSRequest:function(t,e){var r;this.util.testCrossdomainXhr()?(r=new h.XMLHttpRequest,r.open(t,e),r.setRequestHeader("Content-Type","text/plain")):"undefined"!==typeof h.XDomainRequest?(r=new h.XDomainRequest,r.open(t,e)):r=null;return r},sendTrackerFault:function(t){this.throttle(t)||(p.isBrowser?r.createElement("img").src=this.trackerFaultEndpoint(t):fetch(this.trackerFaultEndpoint(t),{mode:"no-cors",__trackjs__:!0}))},sendUsage:function(t){p.isBrowser?r.createElement("img").src=this.usageEndpoint(t):fetch(this.usageEndpoint(t),{mode:"no-cors",__trackjs__:!0})},sendError:function(t,e){var r=this;if(!this.disabled&&!this.throttle(t))try{if(p.isBrowser){var n=this.getCORSRequest("POST",this.errorEndpoint(e));n.onreadystatechange=function(){4!==n.readyState||p.contains([200,202],n.status)||(r.disabled=!0)};n._trackJs=s;n.send(h.JSON.stringify(t))}else if(p.isWorker){var i={method:"POST",mode:"cors",body:h.JSON.stringify(t),__trackjs__:1};fetch(this.errorEndpoint(e),i).then(function(t){t.ok||(r.disabled=!0)})["catch"](function(t){r.disabled=!0})}}catch(t){throw this.disabled=!0,t}},throttle:function(t){var e=(new Date).getTime();this.throttleStats.attemptCount++;if(this.throttleStats.lastAttempt+1e3>=e){if(this.throttleStats.lastAttempt=e,10<this.throttleStats.attemptCount)return this.throttleStats.throttledCount++,!0}else t.throttled=this.throttleStats.throttledCount,this.throttleStats.attemptCount=0,this.throttleStats.lastAttempt=e,this.throttleStats.throttledCount=0;return!1}};var p=function(){function o(r,t,n,i){n=n||!1;i=i||0;p.forEach(t,function(e){p.forEach(p.keys(e),function(t){null===e[t]||e[t]===s?r[t]=e[t]:n&&10>i&&"[object Object]"===a(e[t])?(r[t]=r[t]||{},o(r[t],[e[t]],n,i+1)):r.hasOwnProperty(t)||(r[t]=e[t])})});return r}function a(t){return Object.prototype.toString.call(t)}return{isBrowser:"undefined"!==typeof h&&"undefined"!==typeof h.document,isWorker:"object"===typeof self&&self.constructor&&0<=(self.constructor.name||"").indexOf("WorkerGlobalScope"),isNode:"undefined"!==typeof process&&null!=process.versions&&null!=process.versions.node,addEventListenerSafe:function(t,e,r,n){t.addEventListener?t.addEventListener(e,r,n):t.attachEvent&&t.attachEvent("on"+e,r)},afterDocumentLoad:function(t){if(p.isWorker)p.defer(t);else{var e=!1;"complete"===r.readyState?p.defer(t):(p.addEventListenerSafe(r,"readystatechange",function(){"complete"!==r.readyState||e||(p.defer(t),e=!0)}),setTimeout(function(){e||(p.defer(t),e=!0)},1e4))}},bind:function(t,e){return function(){return t.apply(e,Array.prototype.slice.call(arguments))}},contains:function(t,e){return 0<=t.indexOf(e)},defaults:function(t){return o(t,Array.prototype.slice.call(arguments,1),!1)},defaultsDeep:function(t){return o(t,Array.prototype.slice.call(arguments,1),!0)},defer:function(t,e){setTimeout(function(){t.apply(e)})},forEach:function(t,e,r){if(p.isArray(t)){if(t.forEach)return t.forEach(e,r);for(var n=0;n<t.length;)e.call(r,t[n],n,t),n++}},getLocation:function(){return h.location.toString().replace(/ /g,"%20")},getLocationURL:function(){return p.parseURL(p.getLocation())},has:function(t,e){try{for(var r=e.split("."),n=t,i=0;i<r.length;i++)if(n[r[i]])n=n[r[i]];else return!1;return!0}catch(t){return!1}},hasFunction:function(t,e){try{return!!t[e]}catch(t){return!1}},hasOwn:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},isArray:function(t){return"[object Array]"===a(t)},isBoolean:function(t){return"boolean"===typeof t||p.isObject(t)&&"[object Boolean]"===a(t)},isBrowserIE:function(t){t=t||h.navigator.userAgent;var e=t.match(/Trident\/([\d.]+)/);return e&&"7.0"===e[1]?11:(t=t.match(/MSIE ([\d.]+)/))?parseInt(t[1],10):!1},isBrowserSupported:function(){var t=this.isBrowserIE();return!t||8<=t},isError:function(t){if(!p.isObject(t))return!1;var e=a(t);return"[object Error]"===e||"[object DOMException]"===e||p.isString(t.name)&&p.isString(t.message)},isElement:function(t){return p.isObject(t)&&1===t.nodeType},isFunction:function(t){return!(!t||"function"!==typeof t)},isNumber:function(t){return"number"===typeof t||p.isObject(t)&&"[object Number]"===a(t)},isObject:function(t){return!(!t||"object"!==typeof t)},isString:function(t){return"string"===typeof t||!p.isArray(t)&&p.isObject(t)&&"[object String]"===a(t)},isWrappableFunction:function(t){return this.isFunction(t)&&this.hasFunction(t,"apply")},isoNow:function(){var t=new Date;return t.toISOString?t.toISOString():t.getUTCFullYear()+"-"+this.pad(t.getUTCMonth()+1)+"-"+this.pad(t.getUTCDate())+"T"+this.pad(t.getUTCHours())+":"+this.pad(t.getUTCMinutes())+":"+this.pad(t.getUTCSeconds())+"."+String((t.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"},keys:function(t){if(!p.isObject(t))return[];var e=[],r;for(r in t)t.hasOwnProperty(r)&&e.push(r);return e},noop:function(){},pad:function(t){t=String(t);1===t.length&&(t="0"+t);return t},parseURL:function(t){var e=t.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};e={protocol:e[2],host:e[4],path:e[5],query:e[6],hash:e[8]};e.origin=(e.protocol||"")+"://"+(e.host||"");e.relative=(e.path||"")+(e.query||"")+(e.hash||"");e.href=t;return e},patch:function(t,e,r){t[e]=r(t[e]||p.noop)},testCrossdomainXhr:function(){return p.isBrowser&&"withCredentials"in new XMLHttpRequest},truncate:function(t,e){t=""+t;if(t.length<=e)return t;var r=t.length-e;return t.substr(0,e)+"...{"+r+"}"},tryGet:function(t,e){try{return t[e]}catch(t){}},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:e&3|8).toString(16)})},wrapError:function(t){var e=t||Object.prototype.toString.call(t);if(e&&e.innerError)return t;var r=Error("TrackJS Caught: "+(e.message||e));r.description="TrackJS Caught: "+e.description;r.file=e.file;r.line=e.line||e.lineNumber;r.column=e.column||e.columnNumber;r.stack=e.stack;r.innerError=t;return r}}}(),g=function(t,e,r,n,i,o){this.util=t;this.log=e;this.onError=r;this.onFault=n;this.options=o;this.document=i;t.isBrowser&&o.enabled&&this.initialize(i)};g.prototype={initialize:function(t){var e=this.util.bind(this.onDocumentClicked,this),r=this.util.bind(this.onInputChanged,this);t.addEventListener?(t.addEventListener("click",e,!0),t.addEventListener("blur",r,!0)):t.attachEvent&&(t.attachEvent("onclick",e),t.attachEvent("onfocusout",r))},onDocumentClicked:function(t){try{var e=this.getElementFromEvent(t);e&&e.tagName&&(this.isDescribedElement(e,"a")||this.isDescribedElement(e,"button")||this.isDescribedElement(e,"input",["button","submit"])?this.writeVisitorEvent(e,"click"):this.isDescribedElement(e,"input",["checkbox","radio"])&&this.writeVisitorEvent(e,"input",e.value,e.checked))}catch(t){this.onFault(t)}},onInputChanged:function(t){try{var e=this.getElementFromEvent(t);if(e&&e.tagName)if(this.isDescribedElement(e,"textarea"))this.writeVisitorEvent(e,"input",e.value);else if(this.isDescribedElement(e,"select")&&e.options&&e.options.length)this.onSelectInputChanged(e);else this.isDescribedElement(e,"input")&&!this.isDescribedElement(e,"input",["button","submit","hidden","checkbox","radio"])&&this.writeVisitorEvent(e,"input",e.value)}catch(t){this.onFault(t)}},onSelectInputChanged:function(t){if(t.multiple)for(var e=0;e<t.options.length;e++)t.options[e].selected&&this.writeVisitorEvent(t,"input",t.options[e].value);else 0<=t.selectedIndex&&t.options[t.selectedIndex]&&this.writeVisitorEvent(t,"input",t.options[t.selectedIndex].value)},writeVisitorEvent:function(t,e,r,n){"password"===this.getElementType(t)&&(r=s);var i=this.getElementAttributes(t);t.innerText&&(i.__trackjs_element_text=this.util.truncate(t.innerText,500));this.log.add("v",{timestamp:this.util.isoNow(),action:e,element:{tag:t.tagName.toLowerCase(),attributes:i,value:this.getMetaValue(r,n)}})},getElementFromEvent:function(t){return t.target||r.elementFromPoint(t.clientX,t.clientY)},isDescribedElement:function(t,e,r){if(t.tagName.toLowerCase()!==e.toLowerCase())return!1;if(!r)return!0;t=this.getElementType(t);for(e=0;e<r.length;e++)if(r[e]===t)return!0;return!1},getElementType:function(t){return(t.getAttribute("type")||"").toLowerCase()},getElementAttributes:function(t){for(var e={},r=Math.min(t.attributes.length,10),n=0;n<r;n++){var i=t.attributes[n];p.contains(["data-value","value"],i.name.toLowerCase())||(e[i.name]=p.truncate(i.value,100))}return e},getMetaValue:function(t,e){return t===s?s:{length:t.length,pattern:this.matchInputPattern(t),checked:e}},matchInputPattern:function(t){return""===t?"empty":/^[a-z0-9!#$%&'*+=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/.test(t)?"email":/^(0?[1-9]|[12][0-9]|3[01])[\/\-](0?[1-9]|1[012])[\/\-]\d{4}$/.test(t)||/^(\d{4}[\/\-](0?[1-9]|1[012])[\/\-]0?[1-9]|[12][0-9]|3[01])$/.test(t)?"date":/^(?:(?:\+?1\s*(?:[.-]\s*)?)?(?:\(\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9])\s*\)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\s*(?:[.-]\s*)?)?([2-9]1[02-9]|[2-9][02-9]1|[2-9][02-9]{2})\s*(?:[.-]\s*)?([0-9]{4})(?:\s*(?:#|x\.?|ext\.?|extension)\s*(\d+))?$/.test(t)?"usphone":/^\s*$/.test(t)?"whitespace":/^\d*$/.test(t)?"numeric":/^[a-zA-Z]*$/.test(t)?"alpha":/^[a-zA-Z0-9]*$/.test(t)?"alphanumeric":"characters"},report:function(){return this.log.all("v")}};var m=function(t,e,r,n,i){this.onError=t;this.onFault=e;this.serialize=r;i.enabled&&this.watchWindowErrors(n);i.promise&&this.watchPromiseErrors(n)};m.prototype={watchPromiseErrors:function(t){var r=this;t.addEventListener?t.addEventListener("unhandledrejection",function(t){try{t=t||{};var e=t.detail?p.tryGet(t.detail,"reason"):p.tryGet(t,"reason");if(e!==s&&null!==e&&!e.__trackjs_state__){if(!p.isError(e))try{throw Error(r.serialize(e))}catch(t){e=t}r.onError("promise",e)}}catch(t){r.onFault(t)}}):p.patch(t,"onunhandledrejection",function(e){return function(t){r.onError("promise",t);e.apply(this,arguments)}})},watchWindowErrors:function(t){var s=this;p.patch(t,"onerror",function(a){return function(t,e,r,n,i){try{if(p.isError(i)){s.onError("window",i);a.apply(this,arguments);return}i=i||{};var o={message:i.message||s.serialize(t),name:i.name||"Error",line:i.line||parseInt(r,10)||null,column:i.column||parseInt(n,10)||null,stack:i.stack||null};"[object Event]"!==Object.prototype.toString.call(t)||e?o.file=i.file||s.serialize(e):o.file=(t.target||{}).src;s.onError("window",o)}catch(t){s.onFault(t)}a.apply(this,arguments)}})}};var t=function(){this.hasInstalled=!1;this.hasEnabled=!0;this.window=h;this.document=r;this.util=p;this.install=p.bind(this.install,this);this.onError=p.bind(this.onError,this);this.onFault=p.bind(this.onFault,this);this.serialize=p.bind(this.serialize,this);this.log=new e(p);this.metadata=new u(this.serialize);var t=h&&(h._trackJs||h._trackJS||h._trackjs);t&&this.install(t)};t.prototype={install:function(t){try{if(p.isNode)return this.warn("monitoring disabled in node"),!1;if(!p.has(t,"token"))return this.warn("missing token"),!1;if(this.hasInstalled)return this.warn("already installed"),!1;this.config=new i(t);this.transmitter=new f(this.util,this.config);this.environment=new c(this.config);this.customer=new a(this.config,this.util,this.log,this.window,this.document);if(!this.config.current.enabled)return this.hasEnabled=!1;this.windowConsoleWatcher=new o(this.util,this.log,this.onError,this.onFault,this.serialize,this.window,this.config.current.console);if(!this.util.isBrowserSupported())return!1;this.callbackWatcher=new n(this.config.current.callback,this.onError,this.onFault);this.visitorWatcher=new g(this.util,this.log,this.onError,this.onFault,this.document,this.config.current.visitor);this.navigationWatcher=new l(this.log,this.config.current.navigation);this.networkWatcher=new d(this.util,this.log,this.onError,this.onFault,this.window,this.config.current.network);this.windowWatcher=new m(this.onError,this.onFault,this.serialize,this.window,this.config.current.window);var e=this;p.afterDocumentLoad(function(){e.transmitter.sendUsage({token:e.customer.token,correlationId:e.customer.correlationId,application:e.config.current.application,x:e.util.uuid()})});return this.hasInstalled=!0}catch(t){return this.onFault(t),!1}},pub:function(){var n=this,t={addMetadata:this.metadata.addMetadata,attempt:function(t,e){try{var r=Array.prototype.slice.call(arguments,2);return t.apply(e||this,r)}catch(t){throw n.onError("catch",t),p.wrapError(t)}},configure:function(t){return!n.hasInstalled&&n.hasEnabled?(n.warn("agent must be installed"),!1):n.config.setCurrent(t)},hash:"ee2d3930f78cfd8bb97c23558688dedfac2d12ce",isInstalled:function(){return n.hasInstalled},install:this.install,removeMetadata:this.metadata.removeMetadata,track:function(e){if(!n.hasInstalled&&n.hasEnabled)n.warn("agent must be installed");else{var t=p.isError(e)?e.message:n.serialize(e);e=e||{};if(!e.stack)try{throw Error(t)}catch(t){e=t}n.onError("direct",e)}},version:"3.10.4",watch:function(e,r){return function(){try{var t=Array.prototype.slice.call(arguments,0);return e.apply(r||this,t)}catch(t){throw n.onError("catch",t),p.wrapError(t)}}},watchAll:function(t){var e=Array.prototype.slice.call(arguments,1),r;for(r in t)"function"!==typeof t[r]||p.contains(e,r)||(t[r]=this.watch(t[r],t));return t}};new o(p,n.log,n.onError,n.onFault,n.serialize,t,i.prototype.defaults.console);return t},onError:function(){var a,s=!1;return function(t,e,r){if(this.hasInstalled&&this.hasEnabled&&p.isBrowserSupported())try{if(r=r||{bindStack:null,bindTime:null,force:!1},e&&p.isError(e)||(e={name:"Error",message:this.serialize(e,r.force)}),-1===e.message.indexOf("TrackJS Caught"))if(s&&-1!==e.message.indexOf("Script error"))s=!1;else{var n=p.defaultsDeep({},{agentPlatform:p.isBrowser?"browser":"worker",bindStack:r.bindStack,bindTime:r.bindTime,column:e.column||e.columnNumber,console:this.windowConsoleWatcher.report(),customer:this.customer.report(),entry:t,environment:this.environment.report(),file:e.file||e.fileName,line:e.line||e.lineNumber,message:e.message,metadata:this.metadata.report(),nav:this.navigationWatcher.report(),network:this.networkWatcher.report(),url:(h.location||"").toString(),stack:e.stack,timestamp:this.util.isoNow(),visitor:this.visitorWatcher.report(),version:"3.10.4"});if(!r.force)try{if(!this.config.current.onError(n,e))return}catch(t){n.console.push({timestamp:this.util.isoNow(),severity:"error",message:t.message});var i=this;setTimeout(function(){i.onError("catch",t,{force:!0})},0)}if(this.config.current.dedupe){var o=(n.message+n.stack).substr(0,1e4);if(o===a)return;a=o}(function(){function t(){var e=0;p.forEach(n.console,function(t){e+=(t.message||"").length});return 8e4<=e}for(var e=0;t()&&e<n.console.length;)n.console[e].message=p.truncate(n.console[e].message,1e3),e++})();this.log.clear();setTimeout(function(){s=!1});s=!0;this.transmitter.sendError(n,this.customer.token)}}catch(t){this.onFault(t)}}}(),onFault:function(t){var e=this.transmitter||new f;t=t||{};t={token:(this.customer||{}).token,file:t.file||t.fileName,msg:t.message||"unknown",stack:(t.stack||"unknown").substr(0,1e3),url:this.window.location,v:"3.10.4",h:"ee2d3930f78cfd8bb97c23558688dedfac2d12ce",x:this.util.uuid()};e.sendTrackerFault(t)},serialize:function(t,e){if(this.hasInstalled&&this.config.current.serialize&&!e)try{return this.config.current.serialize(t)}catch(t){this.onError("catch",t,{force:!0})}return i.prototype.defaults.serialize(t)},warn:function(t){p.has(h,"console.warn")&&h.console.warn("TrackJS: "+t)}};return(new t).pub()}("undefined"===typeof self?void 0:self,"undefined"===typeof document?void 0:document);